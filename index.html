<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Devi - Conversational Bot | ElevenLabs</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(135deg, #4E61D3, #8EA6FF);
      color: white;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      text-align: center;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }
    p {
      font-size: 1.1rem;
      margin: 0.5rem 1rem 1.5rem;
      color: #e6e6e6;
    }
    button {
      background-color: white;
      color: #4E61D3;
      border: none;
      padding: 1rem 2rem;
      font-size: 1.1rem;
      border-radius: 30px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
    }
    button:hover {
      background: linear-gradient(90deg, #8EA6FF, #4E61D3);
      color: white;
      transform: scale(1.05);
    }
    #avatar {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid white;
      margin-bottom: 20px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.3);
    }
    #widgetHost {
      margin-top: 20px;
      width: 100%;
      display: flex;
      justify-content: center;
    }
    @media (max-width: 600px) {
      h1 { font-size: 1.5rem; }
      p { font-size: 1rem; }
      button { width: 80%; font-size: 1rem; padding: 0.8rem; }
    }
  </style>
</head>

<body>
  <!-- Avatar -->
  <img id="avatar" src="https://raw.githubusercontent.com/padmanabhnargunde/Devi---Conversational-Bot-Elevan-Labs-/main/Gemini_Generated_Image_930sx930sx930sx9.png" alt="Devi - AI Course Advisor" />
  
  <!-- Title and description -->
  <h1>Talk to Devi</h1>
  <p>Your friendly AI course advisor. Click below to start a voice chat!</p>

  <!-- Button -->
  <button id="openWidget">üéôÔ∏è Talk to Devi</button>
  <div id="widgetHost"></div>

  <!-- ElevenLabs Voice Widget Script -->
  <script>
    const ELEVEN_AGENT_TAG = '<elevenlabs-convai agent-id="agent_8701k6zhc5jrerjafwcgdqrvvf0a"></elevenlabs-convai>';
    const ELEVEN_SCRIPT = 'https://unpkg.com/@elevenlabs/convai-widget-embed';
    const openBtn = document.getElementById('openWidget');
    const host = document.getElementById('widgetHost');

    function injectWidgetAndAutoStart(){
      if (document.querySelector('elevenlabs-convai')) return;
      host.innerHTML = ELEVEN_AGENT_TAG;

      const s = document.createElement('script');
      s.src = ELEVEN_SCRIPT;
      s.async = true;
      s.type = 'text/javascript';

      s.onload = () => {
        console.log('ElevenLabs widget loaded');
        const maxMs = 8000;
        const intervalMs = 250;
        let elapsed = 0;
        const id = setInterval(()=>{
          elapsed += intervalMs;
          const maybeButtons = host.querySelectorAll('button, [role="button"], .call-btn, .phone-button, .convai-call-button, .callButton');
          if (maybeButtons && maybeButtons.length){
            for (const b of maybeButtons){
              try {
                if (b && b.offsetParent !== null) {
                  b.click();
                  console.log('Auto-clicked widget phone button');
                  clearInterval(id);
                  return;
                }
              } catch(e){}
            }
          }
          if (elapsed > maxMs) {
            clearInterval(id);
            console.log('Phone button not found ‚Äî manual click may be needed');
          }
        }, intervalMs);
      };

      s.onerror = () => {
        console.warn('Failed to load ElevenLabs widget script');
        alert('Unable to load voice widget. Please try again in a moment.');
      };

      document.body.appendChild(s);
      host.scrollIntoView({behavior:'smooth', block:'center'});
    }

    openBtn.addEventListener('click', ()=>{
      if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia){
        navigator.mediaDevices.getUserMedia({audio:true}).then(stream=>{
          stream.getTracks().forEach(t=>t.stop());
          injectWidgetAndAutoStart();
        }).catch(()=>{
          injectWidgetAndAutoStart();
        });
      } else {
        injectWidgetAndAutoStart();
      }
    });
  </script>
</body>
</html>
